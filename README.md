This script imports a list of contacts and leads into Close from a CSV file. It then does data analysis on those contacts, outputting a CSV with information on the number of leads in different states and information about the revenue generated by those leads. 

The following external libraries (which can be downloaded through pip), are needed. 
  * `nameparser`
  * `email_validator`
  * `closeio_api`

The script itself is in the `closeimportscript.py` file.

It expect a file named datacsv.csv to exist in the same directory as the script. This file should contain the data to import.

The output of the script will be saved to `output.csv` This file should not exist when the script is ran. 

It expects a header row in the CSV that is as follows 

`Company,Contact Name,Contact Emails,Contact Phones,custom.Company Founded,custom.Company Revenue,Company US State`

Each following row should have the corresponding data ie. Company being the first cell in the row, Contact Name being the second and so on. 

When ran it will prompt for the API key which is to be used in uploading the data to Close.

After it finishes uploading the leads/contacts, it will then run the data analysis. It will prompt the user for a start and end date range. It will analyse the leads occuring between that range. 

It will go through through the contacts (ie. rows in the CSV), and make a list of all of the company names in the company field of the CSV , and will make a list of every company that exists in the CSV field (avoiding duplicates for companies which occur with more than one contact). It uses a SQLite database that exists in memory (not in the file system or output) to help with this, adding the content of the CSV to that database.

It will create the lead objects in Close, one lead for each distinct company name seen in the  CSV file. The name of the lead will be set to the name of the company. The state, revenue and  founding date is set by looking for the first contact/row in the CSV which is tied to that company. The data in that row will be used to set the value of the data in the lead.

The script assumes that the custom fields already exists as possible custom fields, and will search for the IDs tied to those custom fields.

It then creates the contact objects for the rows in the CSV. It will only do this the rows that have enough data to create a contact, this data is at least one of the following: a name, an email address, or a phone number. In cases where the CSV has an item where the CSV contains more than one email address or phone number per contact, it will split this data, and add both email addresses or phone numbers where possible. 

The script will clean any invalid data before creating the contact. This includes fixing the capitalization of the name (using the `nameparser` library), and checking the validity of the email addresses using the `email_validator` library (removing email addresses that are not in the proper syntax, checking that the email address corresponds to an actual/possible email domain name).

When preparing the data analysis, the script will create an internal mapping of each state to the relevant data about that state. 

The script will iterate through each of the companies, adding new states to the blank dictionaries used for this mapping. It uses a similar process to the lead import to avoid duplicate companies and handle companies/leads with more than one contact.

It updates the current state of those dictionaries as it goes through each company.


